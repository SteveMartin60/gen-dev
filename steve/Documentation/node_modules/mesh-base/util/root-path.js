const path = require('path');
const fs   = require('fs'  );

//..............................................................................
// TODO: Hack to determine Mesheven Root dir.
// Walk up the directory tree until we find a 'credentials' directory - Leo
function getPathRoot(dir)
{
    const driveRoot  = path.resolve('/');
    const parentDir  = path.resolve(dir, '..');
    const builderDir = path.resolve(parentDir, 'credentials');
    let   isPathRoot = null;

    try
    {
        isPathRoot = fs.statSync(builderDir).isDirectory();
    }
    catch (e)
    {
        if (driveRoot == parentDir)
        {
            console.error('Failed to resolve Mesh Root Path');
            process.exit();
        }
    }

    if (isPathRoot)
    {
        console.log('Mesheven Root Directory:', parentDir );
        return parentDir
    }
    else
    {
        return getPathRoot(parentDir);
    }
}
//..............................................................................

module.exports = getPathRoot;